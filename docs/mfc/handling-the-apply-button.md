---
title: '[適用] ボタンの処理'
ms.date: 11/04/2016
helpviewer_keywords:
- Apply button in property sheet
- property sheets, Apply button
ms.assetid: 7e977015-59b8-406f-b545-aad0bfd8d55b
ms.openlocfilehash: cd1254a31491e713513f0db0d4cf87baddd9bb23
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/09/2020
ms.locfileid: "84618611"
---
# <a name="handling-the-apply-button"></a>[適用] ボタンの処理

プロパティシートには、標準のダイアログボックスでは使用できない機能があります。これにより、ユーザーは、プロパティシートを閉じる前に行った変更を適用できます。 これを行うには、[適用] ボタンを使用します。 この記事では、この機能を適切に実装するために使用できる方法について説明します。

モーダルダイアログボックスは通常、ユーザーが [OK] をクリックしてダイアログボックスを閉じるときに、外部オブジェクトに設定を適用します。 プロパティシートの場合も同様です。ユーザーが [OK] をクリックすると、プロパティシートの新しい設定が有効になります。

ただし、[プロパティシート] ダイアログボックスを閉じなくても、ユーザーが設定を保存できるようにすることができます。 これは [適用] ボタンの機能です。 [適用] ボタンをクリックすると、現在アクティブになっているページの現在の設定のみを適用するのではなく、すべてのプロパティページの現在の設定が外部オブジェクトに適用されます。

既定では、[適用] ボタンは常に無効になっています。 適切なタイミングで [適用] ボタンを有効にするコードを記述する必要があります。また、以下に説明するように、Apply の効果を実装するコードを記述する必要があります。

ユーザーに適用機能を提供したくない場合は、[適用] ボタンを削除する必要はありません。 これは無効のままにしておくことができます。これは、Windows の将来のバージョンで使用できる標準のプロパティシートのサポートを使用するアプリケーションの間で共通であるためです。

ページを変更中として報告し、[適用] ボタンを有効にするには、を呼び出し `CPropertyPage::SetModified( TRUE )` ます。 ページのいずれかのレポートが変更されている場合、現在アクティブなページが変更されているかどうかに関係なく、[適用] ボタンは有効のままになります。

ユーザーがページの設定を変更するたびに、 [CPropertyPage:: SetModified](reference/cpropertypage-class.md#setmodified)を呼び出す必要があります。 ユーザーがページの設定を変更したことを検出する方法の1つは、 **EN_CHANGE**や**BN_CLICKED**など、プロパティページの各コントロールに対して変更通知ハンドラーを実装することです。

[適用] ボタンの効果を実装するには、プロパティシートで、プロパティページの現在の設定を適用するために、その所有者またはアプリケーション内の他の外部オブジェクトを通知する必要があります。 同時に、プロパティシートで、 `CPropertyPage::SetModified( FALSE )` 外部オブジェクトに対する変更を適用したすべてのページに対してを呼び出すことによって、[適用] ボタンを無効にする必要があります。

このプロセスの例については、MFC の一般的なサンプル[PROPDLG](../overview/visual-cpp-samples.md)を参照してください。

## <a name="see-also"></a>関連項目

[プロパティシート](property-sheets-mfc.md)
