---
title: CFileDialog クラス
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 94530f17c801c62005e837055ce3608e2eaa512f
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/31/2018
ms.locfileid: "50499685"
---
# <a name="cfiledialog-class"></a>CFileDialog クラス

ファイルを開くまたは保存する操作に使用される、コモン ダイアログ ボックスをカプセル化します。

## <a name="syntax"></a>構文

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|`CFileDialog` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|ダイアログ ボックスに、チェック ボタンを追加します。|
|[CFileDialog::AddComboBox](#addcombobox)|ダイアログ ボックスに、コンボ ボックスを追加します。|
|[CFileDialog::AddControlItem](#addcontrolitem)|ダイアログ ボックスで、コンテナー コントロールに項目を追加します。|
|[CFileDialog::AddEditBox](#addeditbox)|ダイアログ ボックスに、エディット ボックスを追加します。|
|[CFileDialog::AddMenu](#addmenu)|ダイアログ ボックスに、メニューを追加します。|
|[CFileDialog::AddPlace](#addplace)|オーバーロードされます。 フォルダーの一覧に配置項目を開いたり保存したりユーザーを追加します。|
|[CFileDialog::AddPushButton](#addpushbutton)|ダイアログ ボックスにボタンを追加します。|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|ダイアログ ボックスに、オプション ボタン (ラジオ ボタンとも呼ばれます) のグループを追加します。|
|[CFileDialog::AddSeparator](#addseparator)|ダイアログ ボックスに、区切り記号を追加します。|
|[CFileDialog::AddText](#addtext)|ダイアログ ボックスにテキスト コンテンツを追加します。|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|状態を更新、`CFileDialog`パラメーターとに格納されているフラグに一致するように、`m_ofn`メンバー変数。|
|[CFileDialog::DoModal](#domodal)|ダイアログ ボックスを表示し、ユーザーが選択できるようにします。|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|ドロップダウン リストを有効に、**オープン**または**保存** ダイアログ ボックスのボタンをクリックします。|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|ダイアログ ボックスのビジュアルのグループに対する要素の追加を停止します。|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|ダイアログ ボックスで、チェック ボタン (チェック ボックス) の現在の状態を取得します。|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|ダイアログ ボックスにあるコンテナー コントロール内のアイテムの現在の状態を取得します。|
|[CFileDialog::GetControlState](#getcontrolstate)|現在の可視性を取得し、特定のコントロールの状態を有効にします。|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|編集ボックス コントロールで現在のテキストを取得します。|
|[CFileDialog::GetFileExt](#getfileext)|選択したファイルの拡張子を返します。|
|[CFileDialog::GetFileName](#getfilename)|選択したファイルのファイル名を返します。|
|[CFileDialog::GetFileTitle](#getfiletitle)|選択したファイルのタイトルを返します。|
|[CFileDialog::GetFolderPath](#getfolderpath)|エクスプ ローラー スタイルの現在開いているフォルダーまたはディレクトリのパスを取得**開く**または**付けて**コモン ダイアログ ボックス。|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|カスタマイズされた内部 COM オブジェクトを取得`CFileDialog`オブジェクト。|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|内部の COM オブジェクトを取得、`CFileDialog`として使用される、**オープン**ファイル ダイアログ ボックス。|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|内部の COM オブジェクトを取得、`CFileDialog`として使用される、**保存**ファイル ダイアログ ボックス。|
|[CFileDialog::GetNextPathName](#getnextpathname)|[次へ] の選択したファイルの完全なパスを返します。|
|[CFileDialog::GetOFN](#getofn)|取得、`OPENFILENAME`の構造、`CFileDialog`オブジェクト。|
|[CFileDialog::GetPathName](#getpathname)|選択したファイルの完全なパスを返します。|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|選択したファイルの読み取り専用の状態を返します。|
|[CFileDialog::GetResult](#getresult)|ユーザーがダイアログ ボックスで行われた選択内容を取得します。|
|[CFileDialog::GetResults](#getresults)|複数選択が可能なダイアログで、ユーザーの選択肢を取得します。|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|ダイアログ ボックスで指定されたコンテナー コントロールからの特定のアイテムを取得します。|
|[CFileDialog::GetStartPosition](#getstartposition)|ファイル名の一覧の最初の要素の位置を返します。|
|[CFileDialog::HideControl](#hidecontrol)|エクスプ ローラー スタイルで指定したコントロールを非表示に**オープン**または**付けて**コモン ダイアログ ボックス。|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|かどうかをフォルダー ピッカー モードでは、現在のダイアログ。|
|[CFileDialog::MakeProminent](#makeprominent)|に比べてコントロールに配置 ダイアログ ボックスが目立つように追加されたその他のコントロールにします。|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|ダイアログ ボックスで、コンテナー コントロールから項目を削除します。|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|ダイアログ ボックスで、チェック ボタン (チェック ボックス) の現在の状態を設定します。|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|ダイアログ ボックスにあるコンテナー コントロールで項目の現在の状態を設定します。|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|コントロールの項目のテキストを設定します。 たとえば、ラジオ ボタンまたはメニュー内の項目に付属しているテキスト。|
|[CFileDialog::SetControlLabel](#setcontrollabel)|ボタンのテキスト ボックスのラベルの編集などのコントロールに関連付けられているテキストを設定します。|
|[CFileDialog::SetControlState](#setcontrolstate)|現在の可視性を設定し、特定のコントロールの状態を有効にします。|
|[CFileDialog::SetControlText](#setcontroltext)|エクスプ ローラー スタイルの指定したコントロールのテキストを設定**オープン**または**付けて**コモン ダイアログ ボックス。|
|[ように cfiledialog::setdefext](#setdefext)|エクスプ ローラー スタイルの既定のファイル名拡張子を設定**オープン**または**付けて**コモン ダイアログ ボックス。|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|編集ボックス コントロールで現在のテキストを設定します。|
|[CFileDialog::SetProperties](#setproperties)|保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|オプション ボタン グループまたは ダイアログ ボックスで、特定のアイテムの選択状態を設定します。|
|[CFileDialog::SetTemplate](#settemplate)|ダイアログ ボックスのテンプレートを設定、`CFileDialog`オブジェクト。|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|ダイアログ ボックスのビジュアルのグループを宣言します。 すべての"add"メソッドに後続の呼び出しでは、このグループにそれらの要素を追加します。|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|格納されているデータを更新、`m_ofn`メンバー変数をファイル ダイアログ ボックスの現在の状態と一致します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|ボタンがクリックされたときに呼び出されます。|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|このチェック ボックスをオン/オフのときに呼び出されます。|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|コントロールがアクティブになるときに呼び出されます。|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|WM_NOTIFY CDN_SELCHANGE メッセージを処理します。|
|[CFileDialog::OnFileNameOK](#onfilenameok)|ダイアログ ボックスに入力したファイル名を検証します。|
|[CFileDialog::OnFolderChange](#onfolderchange)|WM_NOTIFY CDN_FOLDERCHANGE メッセージを処理します。|
|[CFileDialog::OnInitDone](#oninitdone)|WM_NOTIFY CDN_INITDONE メッセージを処理します。|
|[CFileDialog::OnItemSelected](#onitemselected)|コンテナーの項目が選択されているときに呼び出されます。|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|ファイルの選択が変更されたときに、カスタム アクションを実行することができます。|
|[CFileDialog::OnShareViolation](#onshareviolation)|共有違反を処理します。|
|[CFileDialog::OnTypeChange](#ontypechange)|WM_NOTIFY CDN_TYPECHANGE メッセージを処理します。|

### <a name="public-data-members"></a>パブリック データ メンバー

|名前|説明|
|----------|-----------------|
|[:M_ofn](#m_ofn)|Windows`OPENFILENAME`構造体。 基本的なファイル ダイアログ ボックスのパラメーターへのアクセスを提供します。|

## <a name="remarks"></a>Remarks

コモン ファイル ダイアログ ボックスでは、ファイルの選択 ダイアログ ボックスなどを実装することによって**ファイルを開く**と**名前を付けて保存**Windows の標準に準拠しているようにします。

使用することができます`CFileDialog`、コンス トラクターを指定すると、現状有または独自のダイアログ ボックス クラスから派生させることができます`CFileDialog`と、ニーズに合わせてコンス トラクターを記述します。 いずれの場合も、これらのダイアログ ボックスと同様に標準の MFC ダイアログ ボックスから派生しているため、 [CCommonDialog クラス](../../mfc/reference/ccommondialog-class.md)します。 `CFileDialog` COMMDLG に依存します。Windows に含まれている DLL ファイルです。

外観と機能の両方、 `CFileDialog` Windows vista またはそれ以降は、Windows の以前のバージョンによって異なります。 既定の`CFileDialog`プログラムがコンパイルし、Windows Vista で実行またはそれ以降の場合に、新しい Windows Vista またはコードを変更せず、後でスタイルを自動的に使用します。 使用して、 *bVistaStyle*この自動更新を手動でオーバーライドするコンス トラクターのパラメーター。 自動更新の例外は、カスタマイズされたダイアログ ボックスです。 これらは新しいスタイルに変換されません。 コンス トラクターの詳細については、次を参照してください。 [CFileDialog::CFileDialog](#cfiledialog)します。

> [!NOTE]
>  コントロールの ID システムとは異なる Windows Vista または Windows の以前のバージョンから後で使用すると、`CFileDialog`します。 すべての参照を更新する必要があります`CFileDialog`Windows の以前のバージョンからプロジェクトを移植する前に、コード内のコントロール。

いくつか`CFileDialog`メソッドは、Windows vista またはそれ以降はサポートされません。 メソッドがサポートされているかどうかについては個々 のメソッドのトピックを確認します。 さらに、Windows vista またはそれ以降、次の継承された関数はサポートされません。

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Windows メッセージ、`CFileDialog`クラスは、使用しているどのオペレーティング システムによって異なります。 たとえば、Windows XP はサポートされません[CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel)と[CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok)の`CFileDialog`クラス。 ただし、Windows Vista およびそれ以降のオペレーティング システムはサポートしています。 詳細については、生成されるさまざまなメッセージと受信される順序は、次を参照してください。 [CFileDialog サンプル: ログ イベントの順序](../../visual-cpp-samples.md)します。

使用する、`CFileDialog`オブジェクトは、まずを使用して、オブジェクトを作成、`CFileDialog`コンス トラクター。 ダイアログ ボックスが構築した後は、設定または任意の値を変更、 [::m_ofn](#m_ofn)値やダイアログ ボックスのコントロールの状態を初期化するためにします。 `m_ofn`型の構造は、`OPENFILENAME`します。 詳細については、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK の構造体。

ダイアログ ボックスのコントロールを初期化した後に呼び出し、 [CFileDialog::DoModal](#domodal)ダイアログを表示する方法、ユーザーが、パスとファイル名を入力するためのボックスです。 `DoModal` ユーザーには、[ok] \(IDOK) またはキャンセル (IDCANCEL) ボタンがクリックしたかどうかを返します。 場合`DoModal`IDOK を返しますのいずれかを使用することができます、`CFileDialog`情報を取得するパブリック メンバー関数は、ユーザーに配置します。

> [!NOTE]
> Windows vista またはそれ以降、複数回[IFileDialog::SetFileTypes](https://msdn.microsoft.com/library/windows/desktop/bb775980)エラーが発生します。 2 番目の呼び出し`SetFileTypes`のすべてのインスタンスを`CFileDialog`Windows Vista またはそれ以降の E_UNEXPECTED が返されます。 いくつか`CFileDialog`メソッドの関数呼び出し`SetFileTypes`します。 たとえば、2 回の呼び出しを`CFileDialog::DoModal`の同じインスタンスに対して、`CFileDialog`が生成されます[ASSERT](diagnostic-services.md#assert)します。

`CFileDialog` 共有違反、ファイル名の検証および変更通知のリスト ボックスのカスタム処理を実行できるいくつかのプロテクト メンバーが含まれています。 これらのプロテクト メンバーは、コールバック関数が、ほとんどのアプリケーションを既定の処理は自動的に実行されるために使用する必要はありません。 標準の仮想関数であるために、これらの関数のメッセージ マップ エントリは必要ありません。

Windows を使用する[情報を得る](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) ダイアログ ボックスの初期化中にエラーが発生したかどうかを判断して、エラーに関する詳細については、関数。

破棄`CFileDialog`オブジェクトが自動的に処理されます。 呼び出す必要はありません[CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog)します。

ユーザーが複数のファイルを選択し、呼び出す前に、ようにを設定できる`DoModal`します。 返される複数のファイル名の一覧を対応するために、独自ファイル名のバッファーを指定する必要があります。 これには、置き換える`m_ofn.lpstrFile`バッファーへのポインターが割り当てられていれば、構築した後、`CFileDialog`を呼び出す前に、`DoModal`します。

さらに、設定する必要があります`m_ofn.nMaxFile`が指すバッファーに文字数を使用して、`m_ofn.lpstrFile`します。 選択するファイルの最大数を設定した場合`n`、必要なバッファー サイズは`n * (_MAX_PATH + 1) + 1`します。 バッファーに返される最初の項目は、ファイルが選択されたフォルダーへのパスです。 Windows Vista またはそれ以降の形式のダイアログ ボックスでは、ディレクトリとファイル名の文字列は、最後のファイル名の後に余分な null 文字で、null で終わる。 この形式は、スペースが含まれる長いファイル名を返すエクスプ ローラー スタイルのダイアログ ボックスを使用できます。 旧式のダイアログ ボックスで、ディレクトリとファイル名の文字列はスペースで区切らし、関数は、スペースを含むファイル名の短いファイル名を使用します。

次の例では、バッファーを使用して取得し、複数のファイル名を表示する方法を示します。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

複数のファイル名を選択すると、ユーザーへの応答のバッファー サイズを変更するから新しいクラスを派生する必要があります`CFileDialog`をオーバーライドし、 [CFileDialog::OnFileNameChange](#onfilenamechange)メソッド。

新しいクラスを派生させる場合`CFileDialog`、すべてのメッセージを処理するメッセージ マップを使用することができます。 既定のメッセージ処理を拡張するには、派生クラスを`CFileDialog`メッセージ マップを新しいクラスに追加し、新しいメッセージのメンバー関数を提供します。 ダイアログ ボックスをカスタマイズするフック関数を提供する必要はありません。

ダイアログ ボックスをカスタマイズするには、派生クラスを`CFileDialog`カスタム ダイアログ ボックスのテンプレートを提供し、拡張コントロールからの通知メッセージを処理するメッセージ マップを追加します。 基本クラスに処理されないメッセージを渡します。 フック関数をカスタマイズする必要はありません。

Windows Vista またはそれ以降のスタイルのどちらを使用しているときに、 `CFileDialog`、メッセージ マップおよびダイアログ ボックスのテンプレートを使用することはできません。 代わりに、同様の機能を COM インターフェイスを使用する必要があります。

使用する方法の詳細についての`CFileDialog`を参照してください[コモン ダイアログ クラス](../../mfc/common-dialog-classes.md)します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxdlgs.h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

ダイアログ ボックスに、チェック ボタンを追加します。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するチェック マークのボタンの ID。

*strLabel*<br/>
チェック ボタンの名前。

*bChecked*<br/>
チェック ボタンの現在の状態を示すブール値。 チェックされている場合は TRUE。FALSE それ以外の場合

### <a name="remarks"></a>Remarks

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

ダイアログ ボックスに、コンボ ボックスを追加します。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するコンボ ボックスの ID。

### <a name="remarks"></a>Remarks

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

ダイアログ ボックスで、コンテナー コントロールに項目を追加します。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
項目を追加するコンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

*strLabel*<br/>
項目のテキスト。

### <a name="remarks"></a>Remarks

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

ダイアログ ボックスに、エディット ボックスを追加します。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加する編集ボックスの ID。

*strText*<br/>
編集ボックスの名前。

### <a name="remarks"></a>Remarks

##  <a name="addmenu"></a>  CFileDialog::AddMenu

ダイアログ ボックスに、メニューを追加します。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するメニューの ID。

*strLabel*<br/>
メニュー名。

### <a name="remarks"></a>Remarks

##  <a name="addplace"></a>  CFileDialog::AddPlace

フォルダーの一覧に配置項目を開いたり保存したりユーザーを追加します。

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>パラメーター

*lpszFolder*<br/>
ユーザーに使用可能にするフォルダーへのパス。 フォルダーのみ指定できます。

*fdap*<br/>
リスト内でフォルダーを配置する場所を指定します。

*psi*<br/>
使用可能にするユーザーにフォルダーを表す IShellItem へのポインター。 フォルダーのみ指定できます。

### <a name="remarks"></a>Remarks

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

ダイアログ ボックスにボタンを追加します。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するボタンの ID。

*strLabel*<br/>
ボタンの名前。

### <a name="remarks"></a>Remarks

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

ダイアログ ボックスに、オプション ボタン (ラジオ ボタンとも呼ばれます) のグループを追加します。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するオプション ボタン グループの ID。

### <a name="remarks"></a>Remarks

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

ダイアログ ボックスに、区切り記号を追加します。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
区切り記号の ID を追加します。

### <a name="remarks"></a>Remarks

##  <a name="addtext"></a>  CFileDialog::AddText

ダイアログ ボックスにテキストを追加します。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するテキストの ID。

*strText*<br/>
テキストの名前。

### <a name="remarks"></a>Remarks

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

現在の状態を更新、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)に格納されている値に基づいて、`m_ofn`データ構造体。

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Remarks

Windows Vista では、メンバーの前に Windows のバージョンで[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)データ構造がの状態と同期が継続的に、`CFileDialog`します。 変更、 [m_ofn](#m_ofn)メンバー変数が、ダイアログ ボックスの状態に直ちに反映されます。 ダイアログ ボックスの状態に変更がすぐに更新することも、`m_ofn`メンバー変数。

Windows Vista 以降では、値、`m_ofn`メンバー変数との状態、`CFileDialog`が同期されるとは限りません。 この関数の状態の強制、`CFileDialog`一致するように更新する、`m_ofn`構造体。 Windows の呼び出し時に自動的にこの関数[CFileDialog::DoModal](#domodal)します。

使用する方法についての詳細、 `CFileDialog` Windows Vista でクラスまたはその後を参照してください[CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)します。

### <a name="example"></a>例

  例をご覧ください[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)します。

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

Windows の標準ファイル ダイアログ ボックスを作成するには、この関数を呼び出します。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>パラメーター

*bOpenFileDialog*<br/>
[in]このパラメーターを作成するダイアログ ボックスの種類を指定します。 構築する場合は TRUE に設定する**ファイルを開く** ダイアログ ボックス。 構築する場合は FALSE に設定する**ファイル名を付けて** ダイアログ ボックス。

*lpszDefExt*<br/>
[in]既定のファイル名拡張子。 ユーザーにはファイル名 ボックスでの既知の拡張子 (ユーザーのコンピューターでアソシエーションを持つもの) が含まれていない場合、拡張機能が指定された*lpszDefExt*ファイル名に自動的に追加されます。 このパラメーターが NULL の場合は、拡張機能は追加されません。

*場合*<br/>
[in]ファイル名ボックスに表示される初期ファイル名。 NULL の場合、初期ファイル名は表示されません。

*dwFlags*<br/>
[in]ダイアログ ボックスをカスタマイズに使用できる 1 つまたは複数のフラグの組み合わせ。 これらのフラグの説明は、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK の構造体。 変更する場合、`m_ofn.Flags`メンバーを構造体を変更内容でビットごとの OR 演算子を使用して、既定の動作をそのまま維持します。

*lpszFilter*<br/>
[in]一連のフィルターを指定する文字列のペア ファイルに適用できます。 フィルターを指定する場合は、フィルター条件に一致するファイルのみがファイルの一覧に表示されます。 ファイル フィルターを操作する方法の詳細については「解説」を参照してください。

*pParentWnd*<br/>
[in]ファイル ダイアログ ボックスの親またはオーナー ウィンドウへのポインター。

*ない dwSize*<br/>
[in]サイズ、`OPENFILENAME`構造体。 この値は、オペレーティング システムのバージョンによって異なります。 MFC では、作成するのに ダイアログ ボックスの適切な種類は、このパラメーターを使用します。 既定のサイズが 0 の場合、MFC コードが適切なダイアログ ボックスのサイズを決定するプログラムを実行するオペレーティング システムのバージョンに基づいています。

*bVistaStyle*<br/>
[in]**注**このパラメーターは、Visual Studio 2008 で使用でき、それ以降がありは Windows Vista またはそれ以降を実行している場合にのみ使用する新しいスタイル ダイアログが発生します。

このパラメーターは、ファイル ダイアログのスタイルを指定します。 True に設定、新しい Vista スタイルを使用してファイル ダイアログ。 それ以外の場合、ダイアログ ボックスの古いスタイルが使用されます。 Vista で実行されている詳細については、「解説」を参照します。

### <a name="remarks"></a>Remarks

いずれかを**ファイルを開く**または**ファイル名を付けて**の値に応じて、ダイアログ ボックスが構築*bOpenFileDialog*します。

使用して既定の拡張子を指定する*lpszDefExt*拡張機能、ユーザーのコンピューター上のファイルの関連付けのある予測可能ではめったにありませんので、予測される動作をられない場合があります。 既定の拡張機能の追加より詳細に制御が必要な場合から、独自のクラスを派生できます`CFileDialog`、オーバーライドと、`CFileDialog::OnFileNameOK`独自の拡張機能の処理を実行するメソッド。

複数のファイルを選択するユーザーを有効にするように、設定を呼び出す前に[DoModal](#domodal)します。 返される複数のファイル名の一覧を格納する独自ファイル名のバッファーを指定する必要があります。 これには、置き換える`m_ofn.lpstrFile`バッファーへのポインターが割り当てられていれば、構築した後、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)を呼び出す前に、`DoModal`します。 さらに、設定する必要があります`m_ofn.nMaxFile`によって指し示されるバッファーの文字数で`m_ofn.lpstrFile`します。 選択するファイルの最大数を設定した場合*n*、必要なバッファー サイズは`n`*(_MAX_PATH + 1) + 1 です。 例えば:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

マウスまたはキーボードを使用して、[エクスプ ローラー スタイル] ダイアログ ボックスのサイズを変更するユーザーを有効にするには、OFN_ENABLESIZING フラグを設定します。 このフラグを設定することは、フック プロシージャまたはカスタム テンプレートを指定する場合にのみ必要です。 フラグは、エクスプ ローラー スタイル ダイアログ ボックスでは; でのみ動作します。旧式のダイアログ ボックスのサイズを変更できません。

*LpszFilter*ファイル名が、ファイルの一覧に表示する必要のあるファイルの種類を決定するパラメーターを使用します。 文字列のペアの最初の文字列には、フィルターがについて説明します2 番目の文字列では、使用するファイル名拡張子を示します。 複数の拡張機能は、区切り記号としてセミコロン (';' の文字) を使用して指定できます。 2 つの文字列の末尾に '&#124;' NULL 文字が続く文字。 使用することも、 [CString](../../atl-mfc-shared/using-cstring.md)このパラメーターのオブジェクト。

などの Microsoft Excel では、ユーザー拡張機能 .xlc (グラフ) または他のユーザーの間で .xls (ワークシート) を持つファイルを開くことができます。 Excel 用のフィルターとしてを記述できます。

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

ただし、この文字列を直接使用する場合は更新、`OPENFILENAME`構造体、null 文字、垂直バーではなく ' \0'、文字列を区切る必要があります ('&#124;')。

*BVistaStyle*パラメーターは、Windows vista またはそれ以降を実行している場合にのみ適用されます。 Windows の以前のバージョンではこのパラメーターは無視されます。 場合*bVistaStyle*が TRUE に設定、Visual Studio 2008 以降のプログラムをコンパイルするときに新しい Vista スタイル**ファイル ダイアログ**使用されます。 それ以外の場合、以前の MFC スタイル**ファイル ダイアログ**使用されます。

ダイアログ テンプレートがダイアログに基づくでサポートされていない*bVistaStyle*

### <a name="example"></a>例

  例をご覧ください[CFileDialog::DoModal](#domodal)します。

##  <a name="domodal"></a>  CFileDialog::DoModal

Windows コモン ファイル ダイアログ ボックスを表示し、ユーザーがファイルとディレクトリを参照し、ファイル名を入力できるようにするには、この関数を呼び出します。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>戻り値

IDOK や IDCANCEL。 IDCANCEL が返された場合は、Windows を呼び出す[情報を得る](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror)エラーが発生したかどうかを判断する関数。

IDOK や IDCANCEL は、ユーザーが [ok] または [キャンセル] ボタンを選択するかどうかを示す定数です。

### <a name="remarks"></a>Remarks

メンバーを設定して、さまざまなファイル ダイアログ ボックスのオプションを初期化する場合、`m_ofn`構造体を呼び出す前に、これを行う必要があります`DoModal`はダイアログ オブジェクトを構築します。

たとえば、ユーザーが複数のファイルを選択できるようにする場合は、設定のように呼び出す前に`DoModal`のこのトピックのコード例に示すようにします。

ダイアログ ボックスの ok または キャンセル ボタン、または終了を選択します ダイアログ ボックスのオプションをクリックするとコントロール、メニュー、コントロールがアプリケーションに返されます。 できますし、設定や情報を取得するには、その他のメンバー関数、ユーザー入力を呼び出す ダイアログ ボックス。

`DoModal` クラスからオーバーライド仮想関数は、`CDialog`します。

### <a name="example"></a>例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

開くときにボタンまたは [保存] ダイアログ ボックスのドロップダウン リストを有効にします。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ドロップダウン リストの ID。

### <a name="remarks"></a>Remarks

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

ダイアログ ボックスのビジュアルのグループに対する要素の追加を停止します。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>戻り値

成功した場合は S_OK を返します。それ以外の場合エラー値。

### <a name="remarks"></a>Remarks

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

ダイアログ ボックスで、チェック ボタン (チェック ボックス) の現在の状態を取得します。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェック ボックスの ID。

*bChecked*<br/>
チェック ボックスの状態。 Checked は true します。FALSE がチェックされていないことを示します。

### <a name="remarks"></a>Remarks

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

ダイアログ ボックスにあるコンテナー コントロール内のアイテムの現在の状態を取得します。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

*dwState*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙体からより多くの値のいずれかを受け取る変数への参照。

### <a name="remarks"></a>Remarks

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

現在の可視性を取得し、特定のコントロールの状態を有効にします。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*dwState*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙体からの 1 つまたは複数の値を受け取る変数への参照。

### <a name="remarks"></a>Remarks

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

編集ボックス コントロールの現在のテキストを取得します。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
編集ボックスの ID。

*strText*<br/>
テキスト値。

### <a name="remarks"></a>Remarks

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

ダイアログ ボックスに入力されたファイル名の拡張子を取得するには、この関数を呼び出します。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>戻り値

ファイル名の拡張子です。

### <a name="remarks"></a>Remarks

たとえば、次のように入力されたファイルの名前がデータの場合です。TXT、 `GetFileExt` "TXT"を返します。

場合`m_ofn.Flags`がように設定すると、この文字列は、最初の文字列を選択すると、ファイル グループのディレクトリ パスの中で、null で終わる文字列のシーケンスが含まれる、ユーザーが選択したすべてのファイル名の後にします。 ファイルのパス名を取得する、[中](#getstartposition)と[に](#getnextpathname)メンバー関数。

##  <a name="getfilename"></a>  CFileDialog::GetFileName

ダイアログ ボックスに入力したファイル名の名前を取得するには、この関数を呼び出します。

```
CString GetFileName() const;
```

### <a name="return-value"></a>戻り値

ファイルの名前です。

### <a name="remarks"></a>Remarks

ファイルの名前には、プレフィックスと拡張機能の両方が含まれています。 たとえば、`GetFileName`が返される"テキスト。DAT"C:\FILES\TEXT.DAT ファイル。

場合`m_ofn.Flags`が、`OFN_ALLOWMULTISELECT`フラグを設定、呼び出す必要があります[中](#getstartposition)と[に](#getnextpathname)ファイルのパス名を取得します。

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

ダイアログ ボックスで入力ファイルのタイトルを取得するには、この関数を呼び出します。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>戻り値

ファイルのタイトル。

### <a name="remarks"></a>Remarks

ファイルのタイトルには、そのプレフィックスにのみ、せず、パスまたは拡張子が含まれています。 たとえば、 `GetFileTitle` C:\FILES\TEXT.DAT ファイルに対して"TEXT"が返されます。

場合`m_ofn.Flags`がように設定すると、この文字列は、最初の文字列を選択すると、ファイル グループのディレクトリ パスの中で、null で終わる文字列のシーケンスが含まれる、ユーザーが選択したすべてのファイル名の後にします。 このため、使用して、[中](#getstartposition)と[に](#getnextpathname)メンバー関数の一覧で、次のファイル名を取得します。

### <a name="example"></a>例

  例をご覧ください[CFileDialog::DoModal](#domodal)します。

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

現在開いているフォルダーまたはエクスプ ローラー スタイルのオープンまたは名前を付けて保存の共通のダイアログ ボックスのディレクトリのパスを取得するには、このメンバー関数を呼び出します。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>戻り値

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)現在開いているフォルダーまたはディレクトリを含むオブジェクト。

### <a name="remarks"></a>Remarks

ダイアログ ボックスを OFN_EXPLORER スタイル; で作成する必要があります。それ以外の場合、メソッドは、アサーションに失敗します。

ダイアログ ボックスが表示されているときにのみ、このメソッドを呼び出すことができます。 ダイアログ ボックスが閉じられた後は、この関数が機能しなくとメソッドは、アサーションに失敗します。

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

内部の COM オブジェクトへのポインターを取得する指定された[CFileDialog](../../mfc/reference/cfiledialog-class.md)。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>戻り値

内部の COM オブジェクトへのポインター、`CFileDialog`します。 このポインターを適切に解放するユーザーの責任になります。

### <a name="remarks"></a>Remarks

Windows Vista でのみ、またはを持つオブジェクトを後でこの関数を使用して*bVistaStyle*を TRUE に設定します。 この関数を使用する場合と*bVistaStyle* false で、リリース モードでは NULL を返すし、デバッグ モードでアサーションをスローします。

詳細については、`IFileDialogCustomize`インターフェイスは、「 [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)します。

### <a name="example"></a>例

この例では、内部の COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista で、または後でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

内部の COM オブジェクトへのポインターを取得する指定された`CFileDialog`。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>戻り値

内部の COM オブジェクトへのポインター、`CFileDialog`します。 このポインターを適切に解放するユーザーの責任になります。

### <a name="remarks"></a>Remarks

Windows Vista でのみ、またはを持つオブジェクトを後でこの関数を使用して*bVistaStyle*を TRUE に設定します。 場合、この関数は NULL を返します、`CFileDialog`でない、**オープン** ダイアログ ボックスまたは*bVistaStyle*が FALSE に設定します。 この最後のケースでのみ、NULL を返しますリリース モードでデバッグ モードでこれはアサーションをスローします。

詳細については、`IFileOpenDialog`インターフェイスは、「 [IFileOpenDialog](https://msdn.microsoft.com/library/windows/desktop/bb775834)します。

### <a name="example"></a>例

この例では、内部の COM オブジェクトを取得します。 このコードを実行するには、Windows Vista で、または後でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

内部の COM オブジェクトへのポインターを取得する指定された`CFileDialog`。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>戻り値

内部の COM オブジェクトへのポインター、`CFileDialog`します。 このポインターを適切に解放するユーザーの責任になります。

### <a name="remarks"></a>Remarks

Windows Vista でのみ、またはを持つオブジェクトを後でこの関数を使用して*bVistaStyle*を TRUE に設定します。 場合、この関数は NULL を返しますが、`CFileDialog`でない、**保存** ダイアログ ボックスまたは*bVistaStyle*が FALSE に設定します。 この最後のケースでのみ、NULL を返しますリリース モードでデバッグ モードでこれはアサーションをスローします。

詳細については、`IFileSaveDialog`インターフェイスは、「 [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)します。

### <a name="example"></a>例

この例では、内部の COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista で、または後でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

ダイアログ ボックスで選択したグループから次のファイル名を取得するには、この関数を呼び出します。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>パラメーター

*pos*<br/>
によって以前返される位置の値への参照を`GetNextPathName`または`GetStartPosition`関数呼び出し。 リストの末尾に達している場合は NULL です。

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>Remarks

ファイル名のパスには、ファイルのタイトルとディレクトリの完全パスが含まれています。 たとえば、 `GetNextPathName` "C:\FILES\TEXT が戻ります。DAT"C:\FILES\TEXT.DAT ファイル。 使用することができます`GetNextPathName`への呼び出しを初期位置を確立する場合は、順方向の反復ループで`GetStartPosition`します。

選択範囲は、1 つのファイルで構成され、そのファイル名が返されます。

##  <a name="getofn"></a>  CFileDialog::GetOFN

関連付けられている取得`OPENFILENAME`構造体。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>戻り値

[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)構造体。

### <a name="remarks"></a>Remarks

外観を初期化するためにこの関数の 2 番目のバージョンを使用して、**ファイルを開く**または**ファイル名を付けて** ダイアログ ボックスに表示される前に、構築した後、`DoModal`メンバー関数。 たとえば、設定、`lpstrTitle`のメンバー`m_ofn`ダイアログ ボックスにはキャプションにします。

##  <a name="getpathname"></a>  CFileDialog::GetPathName

ダイアログ ボックスに入力されたファイルの完全なパスを取得するには、この関数を呼び出します。

```
CString GetPathName() const;
```

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>Remarks

ファイル名のパスには、ファイルのタイトルとディレクトリの完全パスが含まれています。 たとえば、 `GetPathName` "C:\FILES\TEXT が戻ります。DAT"C:\FILES\TEXT.DAT ファイル。

場合`m_ofn.Flags`がように設定すると、この文字列は、シーケンスが含まれる、ユーザーが選択したすべてのファイル名を使用して null で終わるの最初の文字列を選択すると、ファイル グループのディレクトリ パスの中で、文字列の後にします。 このため、使用して、[中](#getstartposition)と[に](#getnextpathname)メンバー関数の一覧で、次のファイル名を取得します。

### <a name="example"></a>例

  例をご覧ください[CFileDialog::DoModal](#domodal)します。

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

読み取り専用チェック ボックスを Windows 標準的なファイルを開くと、ファイル名を付けて ダイアログ ボックスで選択されているかどうかを判断するには、この関数を呼び出します。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>戻り値

0 以外の値 ダイアログ ボックスでの読み取り専用チェック ボックスがオンの場合それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

OFN_HIDEREADONLY スタイルを設定して、読み取り専用チェック ボックスを非表示にできます、`CFileDialog`コンス トラクター。

> [!NOTE]
> Windows Vista またはそれ以降のスタイル`CFileDialog`オブジェクトはこの関数をサポートしていません。 Windows Vista またはそれ以降のスタイルに対してこの関数を使用しようとしています。`CFileDialog`がスローされます[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)します。

##  <a name="getresult"></a>  CFileDialog::GetResult

ユーザーがダイアログ ボックスで行われた選択内容を取得します。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>戻り値

ユーザーの選択項目を表す IShellItem へのポインター。

### <a name="remarks"></a>Remarks

##  <a name="getresults"></a>  CFileDialog::GetResults

複数選択が可能なダイアログで、ユーザーの選択肢を取得します。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>戻り値

使用するダイアログ ボックスで選択した項目のアクセスに使用できる、IShellItemArray へのポインター。

### <a name="remarks"></a>Remarks

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

ダイアログ ボックスで指定されたコンテナー コントロールからの特定のアイテムを取得します。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
ユーザーがコントロールで選択した項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

場合に、リスト内の最初のファイルのパス名の位置を取得するには、このメンバー関数を呼び出す`m_ofn.Flags`に設定するようにします。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>戻り値

反復処理に使用できる位置の値リストが空の場合は NULL です。

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

エクスプ ローラー スタイルのオープンまたは名前を付けて保存の共通のダイアログ ボックスで指定したコントロールを非表示にするには、このメンバー関数を呼び出します。

```
void HideControl(int nID);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
非表示にするコントロールの ID。

### <a name="remarks"></a>Remarks

ダイアログ ボックスを OFN_EXPLORER スタイル; で作成する必要があります。それ以外の場合、アサーションと、関数は失敗します。

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

現在のダイアログ ボックスがフォルダー ピッカー モードのかどうかを判断します。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>戻り値

ダイアログ ボックスがフォルダー ピッカー モードでは、TRUE を返します。それ以外の場合は FALSE です。

### <a name="remarks"></a>Remarks

##  <a name="m_ofn"></a>  :M_ofn

`m_ofn` 型の構造体は、`OPENFILENAME`します。 この構造内のデータの現在の状態を表す、`CFileDialog`します。

### <a name="remarks"></a>Remarks

外観を初期化するために、この構造体を使用して、**ファイルを開く**または**ファイル名を付けて** ダイアログ ボックスを表示する前に、構築した後、 [DoModal](#domodal)メソッド。 たとえば、設定、*キャプションを表示*のメンバー`m_ofn`ダイアログ ボックスにはキャプションにします。

Windows Vista またはそれ以降のスタイルの[CFileDialog](../../mfc/reference/cfiledialog-class.md)、 `m_ofn`  ダイアログ ボックスの状態を常に一致するようには保証されません。 Windows の以前のバージョン ダイアログ ボックスと同期されます。 参照してください[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)と[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)同期の詳細については、`m_ofn`構造と`CFileDialog`状態Windows vista またはそれ以降。

Windows Vista またはそれ以降の形式のファイル ダイアログ特定のメンバーとのフラグをサポートしていない、`CFileDialog`します。 その結果、これらは影響しません。

Windows Vista またはそれ以降はサポートされていないメンバーの一覧を次には。

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

次のフラグはサポートされていませんので影響を与えませんするときに、Windows Vista またはそれ以降のスタイルの`CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - 常に効果的で Windows Vista またはそれ以降

- OFN_NOLONGNAMES - は、Windows Vista またはそれ以降に効果的に常にオフします。

- OFN_NONETWORKBUTTON - 常に効果的で Windows Vista またはそれ以降

- OFN_READONLY

- OFN_SHOWHELP

この構造体の詳細については、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK の構造体。

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

に比べてコントロールに配置 ダイアログ ボックスが目立つように他のコントロールにします。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

### <a name="remarks"></a>Remarks

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

ボタンがクリックされたときに呼び出されます。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ボタンの ID。

### <a name="remarks"></a>Remarks

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

チェック ボックスがオンまたはオフに呼び出されます。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェック ボックスの ID。

*bChecked*<br/>
Checked または unchecked します。

### <a name="remarks"></a>Remarks

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

コントロールがアクティブ化されるときに呼び出されます。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

### <a name="remarks"></a>Remarks

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

WM_NOTIFY CDN_SELCHANGE メッセージを処理する場合は、このメソッドをオーバーライドします。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Remarks

ユーザーのファイル リストに新しいファイルまたはフォルダーを選択すると、システムが CDN_SELCHANGE メッセージを送信、**オープン**または**付けて** ダイアログ ボックス。 このメッセージに応答アクションを実行する場合は、このメソッドをオーバーライドします。

システムは、OFN_EXPLORER フラグをオンにします ダイアログ ボックスが作成された場合にのみ、このメッセージを送信します。 通知の詳細については、次を参照してください。 [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange)します。 OFN_EXPLORER フラグについては、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)構造と[オープンとダイアログ ボックスとして保存](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)します。

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

コモン ファイル ダイアログ ボックスに入力されたファイル名のカスタム検証を提供したい場合にのみ、この関数をオーバーライドします。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>戻り値

ファイル名が有効なファイル名ではない場合は 1それ以外の場合 0 を返します。

### <a name="remarks"></a>Remarks

この関数では、何らかのアプリケーション固有のファイル名を拒否できます。 通常、フレームワークはファイル名の既定の検証を提供し、無効なファイル名を入力した場合、メッセージ ボックスが表示されますので、この関数を使用する必要はありません。

1 が返されると、ダイアログ ボックスが別のファイル名を入力するユーザーに対して表示のままになります。 ダイアログの手順は、戻り値が 0 の場合、ダイアログ ボックスを破棄します。 値は現在予約されているとは使用できません、他の 0 以外のメッセージが返されます。

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

WM_NOTIFYCDN_FOLDERCHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Remarks

新しいフォルダーを開く または 名前を付けて保存 ダイアログ ボックスで開いたときに、通知メッセージが送信されます。

ダイアログ ボックスが OFN_EXPLORER スタイルで作成された場合にのみ、通知が送信されます。 通知の詳細については、次を参照してください。 [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange)します。 OFN_EXPLORER スタイルの詳細については、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)構造と[オープンとダイアログ ボックスとして保存](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)します。

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

WM_NOTIFY CDN_INITDONE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Remarks

システムのコントロールでの配置が完了すると、システムがこの通知メッセージを送信、**オープン**または**名前を付けて保存**子ダイアログ ボックスのコントロールを配置する ダイアログ ボックス。

システムはこのダイアログ ボックスが OFN_EXPLORER スタイルで作成された場合にのみ送信します。 通知の詳細については、次を参照してください。 [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone)します。 OFN_EXPLORER スタイルの詳細については、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)構造と[オープンとダイアログ ボックスとして保存](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)します。

> [!NOTE]
> Windows Vista またはそれ以降の形式のファイル ダイアログでは、この関数をサポートしていません。 Windows Vista またはそれ以降のスタイル ファイル ダイアログでこの関数を使用するとスローされます[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)します。

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

コンテナーの項目が選択されているときに呼び出されます。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

この関数は、リスト ボックスの現在の選択が変更されるたびに呼び出されます。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*nIDBox*<br/>
リスト ボックスまたはコンボ ボックスの選択範囲が発生したの ID。

*iCurSel*<br/>
現在の選択範囲のインデックス。

*nCode*<br/>
コントロールの通知コード。 このパラメーターは、次の値のいずれかが必要です。

- CD_LBSELCHANGE 指定*iCurSel*単一選択のリスト ボックスで選択された項目。

- CD_LBSELSUB を指定する*iCurSel*は複数選択のリスト ボックスで選択解除されます。

- CD_LBSELADD を指定する*iCurSel*複数選択のリスト ボックスで選択されています。

- CD_LBSELNOITEMS では、複数選択のリスト ボックスで選択が存在しないことを指定します。

### <a name="remarks"></a>Remarks

リスト ボックスで選択範囲の変更のカスタム処理を提供するには、この関数をオーバーライドします。 たとえばへのアクセス権を表示するこの関数を使用することができます。 または日付-前回変更された各ファイルのユーザーを選択します。

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

共有違反のカスタム処理を提供するには、この関数をオーバーライドします。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>パラメーター

*終了*<br/>
共有違反が発生したファイルのパス。

### <a name="return-value"></a>戻り値

次のいずれかの値です。

- OFN_SHAREFALLTHROUGH ファイル名は、ダイアログ ボックスから返されます。

- OFN_SHARENOWARN いいえ。 さらにアクションを実行する必要があります。

- OFN_SHAREWARN、ユーザーは、このエラーの標準の警告メッセージを受信します。

### <a name="remarks"></a>Remarks

通常、フレームワークが既定の共有違反のチェックを提供します。 共有違反が発生した場合、メッセージ ボックスが表示されますので、この関数を使用する必要はありません。

共有違反チェックを無効にする場合は、ビットごとの OR 演算子を使用して、OFN_SHAREAWARE フラグを結合すると`m_ofn.Flags`します。

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

WM_NOTIFYCDN_TYPECHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Remarks

[開くファイルの種類の一覧から新しいファイル型または名前を付けて保存] ダイアログ ボックスを選択すると、通知メッセージが送信されます。

ダイアログ ボックスが OFN_EXPLORER スタイルで作成された場合にのみ、通知が送信されます。 通知の詳細については、次を参照してください。 [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange)します。 OFN_EXPLORER スタイルの詳細については、次を参照してください。、 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)構造と[オープンとダイアログ ボックスとして保存](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)します。

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

ダイアログ ボックスで、コンテナー コントロールから項目を削除します。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
項目を削除するコンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

ダイアログ ボックスで、チェック ボタン (チェック ボックス) の現在の状態を設定します。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェック ボックスの ID。

*bChecked*<br/>
チェック ボックスの状態。 Checked は true します。オフにした場合を示します。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

ダイアログ ボックスにあるコンテナー コントロールで項目の現在の状態を設定します。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

*dwState*<br/>
1 つまたは複数値 CDCONTROLSTATE 列挙体から新しいコントロールの状態を示す。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

コントロールの項目のテキストを設定します。 たとえば、ラジオ ボタンまたはメニュー内の項目に付属しているテキスト。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
項目の ID。

*strLabel*<br/>
項目のテキスト。

### <a name="remarks"></a>Remarks

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

ボタンのテキスト ボックスのラベルの編集などのコントロールに関連付けられているテキストを設定します。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*strLabel*<br/>
コントロールの名前。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

現在の可視性を設定し、特定のコントロールの状態を有効にします。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*dwState*<br/>
1 つまたは複数の値 CDCONTROLSTATE 列挙体からコントロールの現在の状態を示す。

### <a name="remarks"></a>Remarks

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

エクスプ ローラー スタイルで指定したコントロールのテキストを設定するには、このメソッドを呼び出す**オープン**または**付けて** ダイアログ ボックス。

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
[in]テキストを設定する対象のコントロールの ID。

*lpsz*<br/>
[in]コントロールに対して設定するテキストを含む文字列へのポインター。

### <a name="remarks"></a>Remarks

この関数の両方のバージョンでは、Unicode を使用するアプリケーションに対して有効です。 ただし、LPCSTR 型のバージョンのみが ANSI を使用するアプリケーションに対して無効です。

このメソッドを使用して、OFN_EXPLORER スタイルでダイアログ ボックスを作成する必要があります。 それ以外の場合、アサーションと、関数は失敗します。

##  <a name="setdefext"></a>  ように cfiledialog::setdefext

エクスプ ローラー スタイルのオープンまたは名前を付けて保存の共通のダイアログ ボックスの既定のファイル名拡張子を設定するには、この関数を呼び出します。

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>パラメーター

*lpsz*<br/>
ダイアログ ボックスのオブジェクトを使用する既定の拡張子を含む文字列へのポインター。 この文字列は、ピリオド (.) を含めることはできません。

### <a name="remarks"></a>Remarks

ダイアログ ボックスを OFN_EXPLORER スタイル; で作成する必要があります。それ以外の場合、アサーションと、関数は失敗します。

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

編集ボックス コントロールで現在のテキストを設定します。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
編集ボックスの ID。

*strText*<br/>
テキスト値。

### <a name="remarks"></a>Remarks

##  <a name="setproperties"></a>  CFileDialog::SetProperties

保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>パラメーター

*lpszPropList*<br/>
";" で区切られた定義済みプロパティのリスト。 フラグの一覧は、次を参照してください。、**フラグ**の[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)します。

### <a name="remarks"></a>Remarks

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

オプション ボタン グループまたは ダイアログ ボックスで、特定のアイテムの選択状態を設定します。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナー コントロールの ID。

*dwIDItem*<br/>
ユーザーがコントロールで選択した項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

ダイアログ ボックスのテンプレートを設定、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)オブジェクト。

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>パラメーター

*nWin3ID*<br/>
[in]非エクスプ ローラーのテンプレート リソースの ID 番号を含む`CFileDialog`オブジェクト。 このテンプレートは、Windows NT 3.51 または OFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*nWin4ID*<br/>
[in]エクスプ ローラーのテンプレート リソースの ID 番号を含む`CFileDialog`オブジェクト。 このテンプレートは、Windows NT 4.0 およびそれ以降のバージョン、Windows 95 および以降のバージョンでのみ、または OFN_EXPLORER スタイルが存在する場合に使用されます。

*lpWin3ID*<br/>
[in]非エクスプ ローラーのテンプレート リソースの名前を含む`CFileDialog`オブジェクト。 このテンプレートは、Windows NT 3.51 または OFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*lpWin4ID*<br/>
[in]エクスプ ローラーのテンプレート リソースの名前を含む`CFileDialog`オブジェクト。 このテンプレートは、Windows NT 4.0 およびそれ以降のバージョン、Windows 95 および以降のバージョンでのみ、または OFN_EXPLORER スタイルが存在する場合に使用されます。

### <a name="remarks"></a>Remarks

指定されたテンプレートの 1 つだけが使用されます。 システムでは、OFN_EXPLORER スタイルおよびオペレーティング システムで、アプリケーションが実行されているかどうかに基づいて、使用するテンプレートを決定します。 Explorer ではないとエクスプ ローラー スタイルのテンプレートの両方を指定すると、Windows NT 3.51、Windows NT 4.0 およびそれ以降のバージョンと Windows 95 および以降のバージョンのサポートが容易になります。

> [!NOTE]
> Windows Vista またはそれ以降のスタイル ファイル ダイアログ ボックスでは、この関数をサポートしていません。 Windows Vista またはそれ以降のスタイル ファイル ダイアログ ボックスでこの関数を使用するとスローされます[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)します。 別の方法では、カスタマイズされたダイアログを使用します。 カスタムの使用の詳細については`CFileDialog`を参照してください[IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)します。

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

ダイアログ ボックスのビジュアルのグループを宣言します。 すべての"add"メソッドに後続の呼び出しでは、このグループにそれらの要素を追加します。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ビジュアルのグループの ID。

*strLabel*<br/>
グループの名前。

### <a name="remarks"></a>Remarks

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

更新プログラム、`m_ofn`のデータ構造、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)内部オブジェクトの現在の状態に基づいて。

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Remarks

Windows Vista では、メンバーの前に Windows のバージョンで[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)データ構造がの状態と同期が継続的に、`CFileDialog`します。 変更、 [m_ofn](#m_ofn)メンバー変数 ダイアログ ボックスの状態に直接影響します。 また、ダイアログの状態を変更はすぐに m_ofn メンバー変数を更新します。

Windows Vista 以降では、`m_ofn`データ構造が自動的に更新されません。 内のデータの精度を保証するために、`m_ofn`メンバー変数を呼び出す必要があります、`UpdateOFNFromShellDialog`データにアクセスする前に関数。 Windows からこの関数が自動的に処理中に[IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)します。

使用する方法についての詳細、 `CFileDialog` Windows Vista でクラスまたはその後を参照してください[CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)します。

### <a name="example"></a>例

この例の更新、`CFileDialog`表示する前にします。 更新する前に、`m_ofn`メンバー変数は、ダイアログ ボックスの現在の状態を同期する必要があります。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>関連項目

[CCommonDialog クラス](../../mfc/reference/ccommondialog-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)

