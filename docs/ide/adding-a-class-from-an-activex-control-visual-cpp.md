---
title: ActiveX コントロールからクラスを追加する
ms.date: 11/08/2018
f1_keywords:
- vc.codewiz.class.axcontrol
helpviewer_keywords:
- ActiveX controls [C++], adding classes
- classes [C++], creating
- ActiveX Control Wizard
- add class from ActiveX control wizard [C++]
ms.assetid: 729fcb37-54b8-44d5-9b4e-50bb16e0eea4
ms.openlocfilehash: 1d91d98082a5c5d6d45bfa31e81c59e8925aa2c2
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/15/2018
ms.locfileid: "51694219"
---
# <a name="add-a-class-from-an-activex-control"></a>ActiveX コントロールからクラスを追加する

このウィザードを使用すると、使用可能な ActiveX コントロールのインターフェイスからの MFC クラスを作成できます。 MFC クラスは、[MFC アプリケーション](../mfc/reference/creating-an-mfc-application.md)、[MFC DLL](../mfc/reference/creating-an-mfc-dll-project.md)、または [MFC ActiveX コントロール](../mfc/reference/creating-an-mfc-activex-control.md)に追加できます。

> [!WARNING]
> Visual Studio 2017 バージョン 15.9 で、Microsoft はこのコード ウィザードを非推奨としました。Visual Studio の今後のバージョンでは削除する予定です。 このウィザードはほとんど使用されません。 このウィザードを削除しても、ATL と MFC の一般的なサポートには影響ありません。 この非推奨に関するご意見を共有したい場合は、[こちらのアンケート](https://www.surveymonkey.com/r/QDWKKCN)にお答えください。 お客様のご意見は私どもにとって重要です。
<!-- Blank comment here to separate the warning and note. -->
> [!NOTE]
> ActiveX コントロールからクラスを追加するのに、Automation を有効にして MFC プロジェクトを作成する必要はありません。

ActiveX コントロールは、コンポーネント オブジェクト モデル (COM) に基づく再利用可能なソフトウェア コンポーネントであり、多岐にわたる OLE の機能をサポートしています。 さまざまなソフトウェアの要件に合わせてカスタマイズできます。 ActiveX コントロールは、通常の ActiveX コントロール コンテナー内で、またはインターネット上の World Wide Web ページで使用できます。

**ActiveX コントロールから MFC クラスを追加するには:**

1. **ソリューション エクスプローラー**または[クラス ビュー](/visualstudio/ide/viewing-the-structure-of-code)のいずれかで、ActiveX コントロール クラスを追加するプロジェクト名を右クリックします。

1. ショートカット メニューの **[追加]** を選択し、次に **[クラスの追加]** を選択します。

1. [[クラスの追加]](../ide/add-class-dialog-box.md) ダイアログ ボックスの **[テンプレート]** ウィンドウで、**[ActiveX コントロールの MFC クラス]**、**[開く]** を順に選択し、[ActiveX コントロール クラス追加ウィザード](#add-class-from-activex-control-wizard)を表示します。

ウィザードでは、ActiveX コントロールに 1 つ以上インターフェイスを追加できます。 また、ウィザードの 1 回のセッションで、複数の ActiveX コントロールからクラスを作成することもできます。

クラスは、システムに登録されている ActiveX コントロールから登録することも、最初にシステムに登録せずに、タイプ ライブラリ ファイル (.tlb、.olb、.dll、.ocx、または .exe) にある ActiveX コントロールから追加することもできます。 ActiveX コントロールの登録の詳細については、「[OLE コントロールの登録](../mfc/reference/registering-ole-controls.md)」を参照してください。

ウィザードでは、選択した ActiveX コントロールから追加した各インターフェイスに対して、[CWnd](../mfc/reference/cwnd-class.md) または [COleDispatchDriver](../mfc/reference/coledispatchdriver-class.md) から派生した MFC クラスが作成されます。

## <a name="in-this-section"></a>このセクションの内容

- [ActiveX コントロール クラス追加ウィザード](#add-class-from-activex-control-wizard)

## <a name="add-class-from-activex-control-wizard"></a>ActiveX コントロール クラス追加ウィザード

このウィザードを使用すると、使用可能な ActiveX コントロールから MFC クラスを作成できます。 ウィザードでは、選択した ActiveX コントロールから追加したインターフェイスごとにクラスを作成します。

- **Add Class From (クラスの追加元)**

  クラスの作成元となる、タイプ ライブラリの場所を指定します。

  |オプション|説明|
  |------------|-----------------|
  |**Registry**|タイプ ライブラリはシステムで登録されます。 登録されているタイプ ライブラリは、**[Available ActiveX controls]\(使用可能な ActiveX コントロール\)** に一覧されます。|
  |**ファイル**|タイプ ライブラリは必ずしもシステムで登録されるわけではありませんが、ファイルには格納されます。 **[場所]** でファイルの場所を指定してください。|

- **Available ActiveX controls (使用可能な ActiveX コントロール)**

  現在、システムで登録されている ActiveX コントロールを指定します。 **[インターフェイス]** リストにそのインターフェイスを表示するには、このリストから ActiveX コントロールを選択します。 ActiveX コントロールの登録の詳細については、「[MFC ActiveX コントロール : ActiveX コントロールの配布](../mfc/mfc-activex-controls-distributing-activex-controls.md)」を参照してください。

  **[Add Class From]\(クラスの追加元\)** の **[ファイル]** を選択した場合、このボックスは変更できません。

- **場所**

  ActiveX コントロールの場所を指定します。 **[Add Class From]\(クラスの追加元\)** の **[ファイル]** をクリックすると、タイプ ライブラリを含むファイルの場所を指定できます。 ファイルの場所を参照するには、省略記号ボタンを選択します。

  **[Add Class From]\(クラスの追加元\)** の **[レジストリ]** を選択した場合、このボックスは変更できません。

- **インターフェイス**

  ActiveX コントロールのインターフェイスを指定します。 このウィザードでは、**[Available ActiveX controls]\(使用可能な ActiveX コントロール\)** 内の現在の選択からのインターフェイス、または **[場所]** で指定されたタイプ ライブラリからのインターフェイスが使用されます。

  |転送ボタン|説明|
  |---------------------|-----------------|
  |**>**|現在、**[インターフェイス]** リストで選択されているインターフェイスを追加します。 インターフェイスが選択されていない場合は使用できません。|
  |**>>**|ActiveX コントロールのすべてのインターフェイスを追加します。 このウィザードでは、**[Available ActiveX controls]\(使用可能な ActiveX コントロール\)** 内の現在の選択からのインターフェイス、または **[場所]** で指定されたタイプ ライブラリからのインターフェイスが使用されます。|
  |**\<**|現在、**[生成されたクラス]** リストで選択されているクラスを削除します。 現在、**[生成されたクラス]** リストでクラスが選択されていない場合は使用できません。|
  |**\<\<**|**[生成されたクラス]** リストのクラスをすべて削除します。 **[生成されたクラス]** リストが空の場合は使用できません。|

- **生成されたクラス**

  [**>**] または [**>>**] ボタンを使用して、追加したインターフェイスから生成されるクラス名を指定します。 このボックスを選択することでクラスを選択してから、上下の方向キーを使用してリスト内をスクロールすることができます。 **[完了]** を選択すると、**[クラス]** ボックス内では作成された各クラス名を確認し、**[.h ファイル]** ボックス内では作成された各ファイル名を確認することができます。 このボックスでは、一度に 1 つのクラスのみを選択できます。

  このリストでクラスを選択して **[<]** を選択すると、クラスを削除できます。 すべてのクラスを削除するときは、**[生成されたクラス]** ボックス内でクラスを選択する必要はありません。 **[<<]** を選択することにより、**[生成されたクラス]** ボックス内のすべてのクラスを削除できます。

- **クラス**

   **[完了]** を選択したときにウィザードによって追加された **[生成されたクラス]** ボックス内で選択されているクラスの名前を指定します。 **Class** ボックスで名前を編集できます。

- **.h ファイル**

  新しいオブジェクトのクラスにヘッダー ファイルの名前を設定します。 既定では、この名前は、**[生成されたクラス]** で指定した名前に基づきます。 選択した場所にファイル名を保存するには、あるいはクラス宣言を既存のファイルに追加するには、省略記号ボタンを選択します。 既存のファイルを選択した場合、ウィザード内で **[完了]** を選択するまで、ファイルは選択した場所に保存されません。

  ウィザードではファイルは上書きされません。 既存のファイルの名前を選択してから **[完了]** を選択した場合、クラス宣言をファイルのコンテンツに追加するかどうかを指定するように、ウィザードから求められます。 ファイルを追加するには、**[はい]** を選択します。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** を選択します。

- **.cpp ファイル**

  新しいオブジェクトのクラスに実装ファイルの名前を設定します。 既定では、この名前は、**[生成されたクラス]** で指定した名前に基づきます。 選択した場所にファイル名を保存するには、省略記号ボタンを選択します。 ウィザード内で **[完了]** を選択するまで、選択した場所にファイルは保存されません。

  ウィザードではファイルは上書きされません。 既存のファイルの名前を選択してから **[完了]** を選択した場合、クラスの実装をファイルのコンテンツに追加するかどうかを指定するように、ウィザードから求められます。 ファイルを追加するには、**[はい]** を選択します。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** を選択します。
